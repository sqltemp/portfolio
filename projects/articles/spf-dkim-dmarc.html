<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SPF, DKIM, DMARC — Mémo pratique pour l’authentification des e-mails</title>
  <meta name="description" content="Mémo professionnel sur SPF, DKIM et DMARC : principes, configuration, priorités de déploiement et contrôle opérationnel pour PME et particuliers avancés.">
  <style>
    /* --- Thème académique sombre (même gabarit que cryptographie-memo.html) --- */
    :root {
      --bg: #0a0f16;
      --panel: #0e1621;
      --ink: #e8f0ff;
      --muted: #b5c7e6;
      --accent: #2a7fff;
      --border: #1b2a3c;
      --radius: 4px;
      --font-serif: 'Georgia', 'Times New Roman', serif;
    }
    html, body {
      margin: 0; padding: 0;
      background: var(--bg); color: var(--ink);
      font-family: var(--font-serif);
      font-size: 17px; line-height: 1.65;
    }
    header, main {
      max-width: 820px;
      margin: 0 auto;
      padding: 40px 25px;
    }
    nav.breadcrumb { margin: -8px 0 8px; }
    nav.breadcrumb a { color: var(--muted); text-decoration: none; }
    nav.breadcrumb a:hover { text-decoration: underline; }
    header h1 {
      font-size: 1.9rem; margin: 0 0 6px; font-weight: 600;
    }
    header .authors {
      font-size: 0.95rem; color: var(--muted); margin-bottom: 14px;
    }
    p { margin: 0 0 14px; text-align: justify; }
    h2 {
      font-size: 1.35rem;
      border-bottom: 1px solid var(--border);
      padding-bottom: 4px;
      margin-top: 36px; margin-bottom: 14px;
    }
    h3 { font-size: 1.1rem; margin: 20px 0 8px; font-weight: 600; }
    ul { margin: 0 0 14px 22px; }
    .panel {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 18px; margin: 16px 0;
      box-shadow: 0 8px 22px rgba(0,0,0,.35);
    }
    .ref {
      font-size: 0.9rem; color: var(--muted);
      line-height: 1.5; margin-left: 1.3rem; text-indent: -1.3rem;
    }
    a { color: var(--accent); text-decoration: none; }
    a:hover { text-decoration: underline; }
    code, pre {
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
      font-size: 0.95em; color: #dbe7ff;
    }
    pre {
      background: #0b1220; border: 1px solid #19263a; border-radius: 6px;
      padding: 12px 14px; overflow: auto;
    }
    .note { color: var(--muted); font-size: .95rem; }
    .footer-note {
      font-size: 0.9rem; color: var(--muted);
      margin-top: 40px; border-top: 1px solid var(--border); padding-top: 12px;
    }
  </style>
</head>

<body>
  <header>
    <nav class="breadcrumb"><a href="./">← Articles</a></nav>
    <h1>SPF, DKIM, DMARC — Mémo pratique pour l’authentification des e-mails</h1>
    <div class="authors">
      SQ — Solutions SQLTemp / Division Cyberdéfense
    </div>
    <p><em>Résumé :</em> Ce mémo présente les mécanismes <strong>SPF</strong>, <strong>DKIM</strong> et <strong>DMARC</strong>,
    leurs rôles complémentaires contre l’usurpation d’identité (spoofing) et l’hameçonnage, ainsi qu’une feuille de route
    de déploiement progressive pour les PME. Il inclut des exemples de zones DNS et des conseils d’observation opérationnelle.</p>
  </header>

  <main>
    <section class="panel">
      <h2>1. Introduction</h2>
      <p>Le courrier électronique reste la première voie d’attaque en entreprise. L’authentification des messages via
      <strong>SPF</strong> (origine autorisée), <strong>DKIM</strong> (intégrité & signature) et <strong>DMARC</strong>
      (politique & reporting) permet de réduire drastiquement l’usurpation de domaine et d’améliorer la délivrabilité.
      Utilisés ensemble, ces mécanismes fournissent un cadre cohérent de confiance.</p>
    </section>

    <section class="panel">
      <h2>2. SPF — Sender Policy Framework</h2>
      <p><strong>Objectif.</strong> Déclarer publiquement (DNS) quelles adresses IP/serveurs sont autorisés à envoyer
      des e-mails pour un domaine. Les serveurs destinataires comparent l’IP émettrice à cette politique.</p>

      <h3>2.1. Principe et évaluation</h3>
      <ul>
        <li>Enregistrement <code>TXT</code> au nom du domaine expéditeur (ex. <code>example.com</code>).</li>
        <li>Mécanismes clés : <code>ip4</code>, <code>ip6</code>, <code>a</code>, <code>mx</code>, <code>include</code>.</li>
        <li>Qualificatifs : <code>+</code> (pass, implicite), <code>~</code> (softfail), <code>-</code> (fail), <code>?</code> (neutral).</li>
      </ul>

      <h3>2.2. Exemple</h3>
      <pre><code>example.com. 3600 IN TXT "v=spf1 ip4:203.0.113.12 include:_spf.mailprovider.com -all"</code></pre>
      <p class="note">Interprétation : une IP interne autorisée, plus l’opérateur SaaS d’envoi. Tout le reste est explicitement refusé (<code>-all</code>).</p>

      <h3>2.3. Bonnes pratiques</h3>
      <ul>
        <li>Limiter les <code>include:</code> pour éviter les dépassements de “10 DNS lookups”.</li>
        <li>Documenter l’inventaire des expéditeurs (M365/Google, CRM, outil marketing, factureur, etc.).</li>
        <li>Terminer par <code>-all</code> après période d’observation (éviter <code>~all</code> en cible).</li>
      </ul>
    </section>

    <section class="panel">
      <h2>3. DKIM — DomainKeys Identified Mail</h2>
      <p><strong>Objectif.</strong> Signer cryptographiquement les messages sortants avec une clé privée. Le serveur
      destinataire vérifie la signature en récupérant la clé publique (<code>TXT</code>) dans le DNS du domaine expéditeur.</p>

      <h3>3.1. Éléments essentiels</h3>
      <ul>
        <li><strong>Sélecteur</strong> (<code>selector</code>) : identifiant libre (ex. <code>m365</code>, <code>news</code>) publié sous <code>selector._domainkey.example.com</code>.</li>
        <li><strong>Paramètres</strong> courants : <code>v=DKIM1; k=rsa; p=...</code> (clé publique), <code>t=s</code> (test), <code>h=</code> (entêtes signés), <code>c=</code> (canonicalisation).</li>
        <li><strong>Tailles de clés</strong> : 2048 bits recommandé.</li>
      </ul>

      <h3>3.2. Exemple d’enregistrement DNS</h3>
      <pre><code>m365._domainkey.example.com. 3600 IN TXT "v=DKIM1; k=rsa; p=MIIBIjANBgkqhkiG9w0BAQEFA..."</code></pre>

      <h3>3.3. Bonnes pratiques</h3>
      <ul>
        <li>Un sélecteur par plateforme d’envoi (M365, outil marketing, ERP). Rotation de clés planifiée.</li>
        <li>Signer au minimum <code>From</code>, <code>Subject</code>, <code>Date</code> et les parties MIME principales.</li>
        <li>Éviter la réécriture en route (passerelles altérant les entêtes).</li>
      </ul>
    </section>

    <section class="panel">
      <h2>4. DMARC — Domain-based Message Authentication, Reporting &amp; Conformance</h2>
      <p><strong>Objectif.</strong> Définir une <em>politique</em> d’acceptation/rejet basée sur les résultats SPF/DKIM
      <em>et</em> leur <strong>alignement</strong> avec le domaine visible dans l’entête <code>From:</code>. Fournit des
      rapports d’observation aux propriétaires du domaine.</p>

      <h3>4.1. Alignement</h3>
      <p>Un message “passe” DMARC si <strong>SPF aligné</strong> ou <strong>DKIM aligné</strong> est valide.
      L’alignement signifie que le domaine évalué par SPF/DKIM correspond (relaxé : même domaine racine ; strict : domaine exact)
      au domaine de l’entête <code>From:</code>.</p>

      <h3>4.2. Exemple d’enregistrement DMARC (phase observation)</h3>
      <pre><code>_dmarc.example.com. 3600 IN TXT "v=DMARC1; p=none; rua=mailto:dmarc-reports@example.com; ruf=mailto:dmarc-forensics@example.com; fo=1; sp=none; adkim=r; aspf=r"</code></pre>

      <h3>4.3. Passage progressif vers l’application</h3>
      <pre><code>_dmarc.example.com. 3600 IN TXT "v=DMARC1; p=quarantine; pct=50; rua=mailto:dmarc-reports@example.com; adkim=s; aspf=s"</code></pre>
      <p class="note">Augmenter <code>pct</code> jusqu’à 100, puis <code>p=reject</code> lorsque tous les expéditeurs légitimes sont couverts.</p>

      <h3>4.4. Paramètres utiles</h3>
      <ul>
        <li><code>p=none|quarantine|reject</code> : politique globale.</li>
        <li><code>sp=...</code> : politique pour les sous-domaines.</li>
        <li><code>rua</code>/<code>ruf</code> : adresses de rapports agrégés/forensic (prévoir une boîte dédiée).</li>
        <li><code>fo</code> : granularité des rapports d’échec (ex. <code>fo=1</code> pour chaque fail).</li>
        <li><code>adkim</code>/<code>aspf</code> : alignement strict (<code>s</code>) ou relaxé (<code>r</code>).</li>
      </ul>
    </section>

    <section class="panel">
      <h2>5. Feuille de route de déploiement (PME)</h2>
      <ol>
        <li><strong>Inventorier</strong> tous les émetteurs (suite bureautique, CRM, marketing, ERP, copieurs, helpdesk).</li>
        <li><strong>Activer DKIM</strong> sur chaque plateforme (prioritaire : signature + intégrité visible).</li>
        <li><strong>Établir SPF</strong> minimal, tester et converger vers <code>-all</code> (après validation).</li>
        <li><strong>Publier DMARC</strong> en <code>p=none</code> avec <code>rua</code> ; analyser 2–4 semaines.</li>
        <li><strong>Corriger</strong> les envois non alignés (alias, sous-domaines, routage via passerelles).</li>
        <li><strong>Monter</strong> progressivement vers <code>quarantine</code> puis <code>reject</code>, <code>adkim/aspf=s</code> si possible.</li>
        <li><strong>Industrialiser</strong> la rotation DKIM (sélecteurs datés) et la revue trimestrielle de SPF.</li>
      </ol>
    </section>

    <section class="panel">
      <h2>6. Contrôle &amp; dépannage</h2>
      <h3>6.1. Symptômes courants</h3>
      <ul>
        <li><strong>SPF “permerror”</strong> : trop de lookups (>10) ou syntaxe incorrecte.</li>
        <li><strong>DKIM “fail (body hash)”</strong> : modification du contenu par une passerelle (bannières, disclaimers).</li>
        <li><strong>DMARC “fail (unaligned)”</strong> : le domaine signé/évalué ne correspond pas au <code>From:</code>.</li>
      </ul>
      <h3>6.2. Conseils</h3>
      <ul>
        <li>Signer côté <em>dernier saut sortant</em> ; éviter les altérations post-signature.</li>
        <li>Normaliser les adresses <code>From:</code> (pas d’expédition via domaines tiers sans sous-domaine dédié).</li>
        <li>Créer un sous-domaine d’envoi marketing (ex. <code>news.example.com</code>) avec ses propres SPF/DKIM/DMARC.</li>
      </ul>
    </section>

    <section class="panel">
      <h2>7. Extensions utiles</h2>
      <ul>
        <li><strong>BIMI</strong> : affichage du logo de marque chez certains fournisseurs, nécessite DMARC à <code>quarantine/reject</code>.</li>
        <li><strong>ARC</strong> : préserve l’authentification à travers les réexpéditions/listes (utile mais distinct de DMARC).</li>
      </ul>
    </section>

    <section class="panel">
      <h2>8. Conclusion</h2>
      <p>SPF, DKIM et DMARC fournissent un triptyque cohérent : origine autorisée, signature vérifiable et politique
      d’application avec visibilité. Pour les PME, une approche par étapes — inventaire, DKIM, SPF, DMARC en observation
      puis application — maximise la sécurité tout en limitant les faux positifs. La supervision continue des rapports
      DMARC assure la pérennité du dispositif.</p>
    </section>

    <h2>Références</h2>
    <p class="ref">[1] RFC 7208 — Sender Policy Framework (SPF).</p>
    <p class="ref">[2] RFC 6376 — DomainKeys Identified Mail (DKIM).</p>
    <p class="ref">[3] RFC 7489 — DMARC: Domain-based Message Authentication, Reporting, and Conformance.</p>
    <p class="ref">[4] RFC 8617 — BIMI (Brand Indicators for Message Identification), informational drafts &amp; specs.</p>
    <p class="ref">[5] M3AAWG — Best Common Practices for Email Senders (deliverability &amp; authentication).</p>

    <div class="footer-note">
      Document préparé par <strong>Solutions SQLTemp</strong> — Novembre 2025. |
      Licence : CC BY-NC 4.0 |
      <a href="./">Retour à la page des articles</a>
    </div>
  </main>
</body>
</html>
